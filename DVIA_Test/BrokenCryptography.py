# coding=utf-8
from SecCheck.seed import API


def check1():
    """
    简化版检测
    1. +[RNEncryptor encryptData:withSettings:password:error:] is invoked and password is constant

    :return:
    """
    pass


class BrokenCryptography:

    def __init__(self):
        pass

    @staticmethod
    def start():
        callee = API(ea=imp)
        for ctx, ea in callee.find_calls_with_detail(gist='ADJ').items():
            cl = CLimitation(ctx, 'SEL', criterion=callee.selector)
            cl.calculate_valid_blocks_to_criterion()                                                                                              cl.ctx)
            callsite = CallSite(callee.ea, ctx, criterion=(rtype, imp, extra))  # to be collected
            CryptoChecker.analyzer.analyze_function(start_addr=cl.ctx)
            constants, symbols = callsite.analyze_results_according_to_criterion()

